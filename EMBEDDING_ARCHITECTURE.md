# EMA Adaptive Decay Model - ì „ì²´ ì„ë² ë”© êµ¬ì¡°

## ğŸ“Š ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ì…ë ¥ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼                                    â”‚
â”‚  timestamp, sensor, value_state, activity                                    â”‚
â”‚  (11,586 events â†’ ì„¼ì„œ 30ê°œ, í™œë™ 5ê°œ)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Sliding Window Sampling   â”‚
                    â”‚  - window_size: 100        â”‚
                    â”‚  - stride: 10              â”‚
                    â”‚  â†’ 1,149 samples           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                        â”‚                        â”‚
        â”‚                        â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Feature Pipelineâ”‚    â”‚ Temporal Features â”‚   â”‚ Skip-gram Pre-   â”‚
â”‚  (Real-time)     â”‚    â”‚  (Computed)       â”‚   â”‚  training         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                       â”‚                        â”‚
        â”‚                       â”‚                        â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Rich Feature Extraction                         â”‚
â”‚  RichFeatureExtractor (model/rich_features.py)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ ê° ìœˆë„ìš° (T=100 timesteps)ì— ëŒ€í•´ 4ê°€ì§€ íŠ¹ì§• ìƒì„±:
        â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                                                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   X_frame      â”‚  â”‚   X_ema    â”‚  â”‚   X_vel    â”‚  â”‚   X_emb   â”‚
â”‚  (T, N_sensor) â”‚  â”‚ (T, N_sensor)â”‚ â”‚   (T, 6)   â”‚  â”‚  (T, 32)  â”‚
â”‚     (100, 30)  â”‚  â”‚  (100, 30) â”‚  â”‚ (100, 6)   â”‚  â”‚ (100, 32) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚                 â”‚                â”‚                â”‚
        â”‚                 â”‚                â”‚                â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Feature Concat    â”‚
                    â”‚  X = [X_frame |    â”‚
                    â”‚       X_ema |      â”‚
                    â”‚       X_vel |      â”‚
                    â”‚       X_emb]       â”‚
                    â”‚  Shape: (T, 98)    â”‚
                    â”‚  = 30+30+6+32      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                   â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Condition      â”‚              â”‚   Delta-t         â”‚
    â”‚   Features       â”‚              â”‚   Matrix          â”‚
    â”‚   (T, 8)         â”‚              â”‚   (T, T)          â”‚
    â”‚   for Î»-MLP      â”‚              â”‚   Time diffs      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                                   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  EMA Adaptive Decay    â”‚
                â”‚  Model                 â”‚
                â”‚  (model/ema_adaptive_  â”‚
                â”‚   decay.py)            â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚   Input     â”‚   â”‚   TCN Backbone   â”‚   â”‚  Attention â”‚
â”‚  Projection â”‚   â”‚   (Temporal)     â”‚   â”‚   Decoder  â”‚
â”‚  (98â†’128)   â”‚   â”‚   3 layers       â”‚   â”‚  (Î»-based) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
        â”‚                   â”‚                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Classifier   â”‚
                    â”‚   (128 â†’ 5)    â”‚
                    â”‚   Activities   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Output       â”‚
                    â”‚   Predictions  â”‚
                    â”‚   (t1~t5)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” ìƒì„¸ ì„ë² ë”© êµ¬ì¡°

### 1ï¸âƒ£ **X_frame: ì´ì§„ ì„¼ì„œ ìƒíƒœ í–‰ë ¬** (100, 30)

```python
# ê° íƒ€ì„ìŠ¤í… të§ˆë‹¤ ì„¼ì„œ í™œì„±í™” ìƒíƒœë¥¼ ì›-í•« ìŠ¤íƒ€ì¼ë¡œ í‘œí˜„
# 
# Example at timestep t:
# [0, 0, 1, 0, ..., 0]  â† M01~M51 ì¤‘ M03ì´ ON
#        â†‘
#     sensor_id=2 activated

êµ¬ì¡°:
- ì°¨ì›: (T, N_sensor) = (100, 30)
- ê°’: Binary (0 or 1)
- ì˜ë¯¸: "ì–´ë–¤ ì„¼ì„œê°€ ì§€ê¸ˆ ì¼œì ¸ ìˆë‚˜?"
- ìš©ë„: ê³µê°„ì  ì„¼ì„œ ë¶„í¬ íŒŒì•…

ìƒì„± ì½”ë“œ (rich_features.py):
def _build_frame_matrix(sensor_ids, states, T):
    X_frame = np.zeros((T, N_sensor))
    for t in range(T):
        sid = sensor_ids[t]
        state_val = 1.0 if states[t] in ['ON','OPEN','PRESENT'] else 0.0
        X_frame[t, sid] = state_val
    return X_frame
```

### 2ï¸âƒ£ **X_ema: EMA í‰í™œí™” íŠ¹ì§•** (100, 30)

```python
# Exponential Moving Averageë¡œ ì‹œê°„ì  ì§€ì†ì„± ë¶€ì—¬
# "ìµœê·¼ì— ìì£¼ í™œì„±í™”ëœ ì„¼ì„œëŠ” ë†’ì€ ê°’ ìœ ì§€"

êµ¬ì¡°:
- ì°¨ì›: (T, N_sensor) = (100, 30)
- ê°’: Continuous [0, 1]
- ì˜ë¯¸: "ì–´ë–¤ ì„¼ì„œê°€ ìµœê·¼ í™œì„±í™” ì¶”ì„¸ì¸ê°€?"
- ìš©ë„: ì‹œê°„ì  íŒ¨í„´ì˜ ë¶€ë“œëŸ¬ìš´ í‘œí˜„

ìˆ˜ì‹:
X_ema[t] = Î± * X_frame[t] + (1-Î±) * X_ema[t-1]
         where Î± = 0.6

Example:
t=0: [0, 0, 1, 0, ...]    â†’ X_ema[0] = [0, 0, 1.00, 0, ...]
t=1: [0, 0, 0, 0, ...]    â†’ X_ema[1] = [0, 0, 0.40, 0, ...]  (decay)
t=2: [0, 0, 1, 0, ...]    â†’ X_ema[2] = [0, 0, 0.76, 0, ...]  (reactivate)

íš¨ê³¼:
- ì¡ìŒ ì œê±° (ë…¸ì´ì¦ˆ í•„í„°ë§)
- ì§€ì†ì  í™œë™ ê°•ì¡°
- ì¼ì‹œì  í™œì„±í™” ê°ì‡ 
```

### 3ï¸âƒ£ **X_vel: ì†ë„/ì´ë™ íŠ¹ì§•** (100, 6)

```python
# ì„¼ì„œ í™œì„±í™”ì˜ ë™ì—­í•™ì  íŠ¹ì§•
# "ì‚¬ìš©ìê°€ ì–¼ë§ˆë‚˜ ë¹ ë¥´ê²Œ ì´ë™í•˜ëŠ”ê°€?"

êµ¬ì¡°:
- ì°¨ì›: (T, 6) = (100, 6)
- ê°’: Normalized [0, 1] or [-1, 1]

6ê°œ íŠ¹ì§•:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature          â”‚ Description                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0. speed         â”‚ 1 / (Î”t_reactivation + Îµ)              â”‚
â”‚                  â”‚ ì„¼ì„œ ì¬í™œì„±í™” ê°„ê²©ì˜ ì—­ìˆ˜                 â”‚
â”‚                  â”‚ ë¹ ë¥¸ ì´ë™ = ë†’ì€ ê°’                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. delta_pos     â”‚ sensor_id[t] - sensor_id[t-1]           â”‚
â”‚                  â”‚ ì„¼ì„œ ID ë³€í™” (ê³µê°„ ì´ë™ ê·¼ì‚¬)             â”‚
â”‚                  â”‚ ì–‘ìˆ˜ = ì „ì§„, ìŒìˆ˜ = í›„ì§„                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. movement_flag â”‚ 1 if speed > threshold else 0           â”‚
â”‚                  â”‚ ì´ë™ ì¤‘/ì •ì§€ ìƒíƒœ êµ¬ë¶„                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. ema_speed     â”‚ EMA ì ìš©ëœ speed                        â”‚
â”‚                  â”‚ í‰í™œí™”ëœ ì†ë„ ì¶”ì„¸                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 4. local_delta_t â”‚ timestamp[t] - timestamp[t-1]           â”‚
â”‚                  â”‚ ì´ë²¤íŠ¸ ê°„ ì‹œê°„ ê°„ê²©                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5. activation_   â”‚ í•´ë‹¹ ì„¼ì„œì˜ ëˆ„ì  í™œì„±í™” íšŸìˆ˜              â”‚
â”‚    count         â”‚ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì„¼ì„œ ì‹ë³„                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ìš©ë„:
- ì´ë™/ì •ì§€ íŒ¨í„´ êµ¬ë¶„
- Î»(ê°ì‡ ìœ¨) í•™ìŠµì˜ ì¡°ê±´ íŠ¹ì§•
- í™œë™ ìœ í˜• ë¶„ë¥˜ ë‹¨ì„œ
```

### 4ï¸âƒ£ **X_emb: Skip-gram ì„¼ì„œ ì„ë² ë”©** (100, 32)

```python
# Word2Vec ìŠ¤íƒ€ì¼ ì„¼ì„œ ì˜ë¯¸ ì„ë² ë”©
# "í•¨ê»˜ í™œì„±í™”ë˜ëŠ” ì„¼ì„œëŠ” ìœ ì‚¬í•œ ë²¡í„°"

ì‚¬ì „ í•™ìŠµ (train_skipgram.py):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Skip-gram with Negative Sampling            â”‚
â”‚ - Embedding dim: 32                         â”‚
â”‚ - Context window: Â±5 events                 â”‚
â”‚ - Negative samples: 5                       â”‚
â”‚ - Epochs: 10                                â”‚
â”‚ - Loss: 2.69 (ìµœì¢…)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í•™ìŠµ ëª©í‘œ:
Maximize: P(context | center_sensor)
         ì˜ˆ) M07 ì£¼ë³€ì— M08, M09 ìì£¼ ë“±ì¥
         â†’ M07, M08, M09 ì„ë² ë”© ë²¡í„°ê°€ ìœ ì‚¬í•´ì§

êµ¬ì¡°:
- ì°¨ì›: (T, 32) = (100, 32)
- ê°’: Continuous [-âˆ, +âˆ] (embedding space)
- ì˜ë¯¸: "ì„¼ì„œ ê°„ ì˜ë¯¸ì  ìœ ì‚¬ë„"

Example embedding space:
  M07 (Kitchen Motion) â”€â”€â”
  M08 (Kitchen Motion) â”€â”€â”¼â”€â”€â”€ "ì£¼ë°© í´ëŸ¬ìŠ¤í„°"
  M09 (Kitchen Door)   â”€â”€â”˜
  
  M13 (Bedroom Motion) â”€â”€â”€â”€â”€ "ì¹¨ì‹¤ í´ëŸ¬ìŠ¤í„°"
  
  D01 (Front Door)     â”€â”€â”
  D02 (Back Door)      â”€â”€â”´â”€â”€â”€ "ì¶œì…êµ¬ í´ëŸ¬ìŠ¤í„°"

ìš©ë„:
- ê³µê°„ì  ì„¼ì„œ ê´€ê³„ í•™ìŠµ
- ì˜ë¯¸ì  íŒ¨í„´ ì¸ì‹
- í™œë™ë³„ ì„¼ì„œ ì¡°í•© êµ¬ë¶„
```

### 5ï¸âƒ£ **Condition Features (cond_feat)** (100, 8)

```python
# Adaptive Î»(ê°ì‡ ìœ¨) í•™ìŠµì„ ìœ„í•œ ì¡°ê±´ íŠ¹ì§•

êµ¬ì¡°:
- ì°¨ì›: (T, 8) = (100, 8)
- ìš©ë„: MLP_Î»ì˜ ì…ë ¥ìœ¼ë¡œ ì‚¬ìš©

8ê°œ íŠ¹ì§•:
â”Œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ # â”‚ Feature         â”‚ Source                       â”‚
â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0 â”‚ speed           â”‚ X_vel[:, 0]                  â”‚
â”‚ 1 â”‚ movement_flag   â”‚ X_vel[:, 2]                  â”‚
â”‚ 2 â”‚ ema_speed       â”‚ X_vel[:, 3]                  â”‚
â”‚ 3 â”‚ local_delta_t   â”‚ X_vel[:, 4]                  â”‚
â”‚ 4 â”‚ sensor_activity â”‚ X_ema[t, sensor_id]          â”‚
â”‚ 5 â”‚ ema_mean        â”‚ X_ema.mean(axis=1)           â”‚
â”‚ 6 â”‚ ema_std         â”‚ X_ema.std(axis=1)            â”‚
â”‚ 7 â”‚ ema_max         â”‚ X_ema.max(axis=1)            â”‚
â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

MLP_Î» êµ¬ì¡°:
cond_feat (8) â†’ Linear(8â†’128) â†’ ReLU â†’ Linear(128â†’4 heads)
              â†’ Softplus â†’ Î»[t,head]

Î»ì˜ ì—­í• :
- ì´ë™ ì¤‘ (movement_flag=1): Î»â†‘ (ë¹ ë¥¸ ê°ì‡ )
  â†’ ìµœê·¼ ì„¼ì„œë§Œ ì¤‘ìš”
- ì •ì§€ ì‹œ (movement_flag=0): Î»â†“ (ëŠë¦° ê°ì‡ )
  â†’ ê¸´ íˆìŠ¤í† ë¦¬ ìœ ì§€
```

### 6ï¸âƒ£ **Delta-t Matrix** (100, 100)

```python
# ì¿¼ë¦¬-í‚¤ ê°„ ì‹œê°„ ì°¨ì´ í–‰ë ¬

êµ¬ì¡°:
- ì°¨ì›: (T, T) = (100, 100)
- ê°’: Absolute time difference (seconds)

ê³„ì‚°:
delta_t[i, j] = |timestamp[i] - timestamp[j]|

Example (ì´ˆ ë‹¨ìœ„):
       Key â†’
Query  t=0  t=1  t=2  t=3  ...
  â†“
t=0    0.0  0.5  1.2  2.0
t=1    0.5  0.0  0.7  1.5
t=2    1.2  0.7  0.0  0.8
t=3    2.0  1.5  0.8  0.0
...

ìš©ë„:
Adaptive Decay Attentionì—ì„œ ì‚¬ìš©:
score[i,j] = (q[i]Â·k[j] / âˆšd) - Î»[i,j] * delta_t[i,j]
                                  â†‘            â†‘
                              í•™ìŠµ ê°€ëŠ¥    ì‹œê°„ ì°¨ì´
íš¨ê³¼:
- ì˜¤ë˜ëœ ê¸°ì–µ ìë™ ê°ì‡ 
- ì‹œê°„ì  ê±°ë¦¬ì— ë”°ë¥¸ ì¤‘ìš”ë„ ì¡°ì ˆ
```

## ğŸ§  ëª¨ë¸ ë‚´ë¶€ ì„ë² ë”© íë¦„

```python
# EMAAdaptiveDecayModel (model/ema_adaptive_decay.py)

class EMAAdaptiveDecayModel(nn.Module):
    def forward(self, X, cond_feat, delta_t, lengths):
        """
        X: (B, T, 98) = concat[X_frame|X_ema|X_vel|X_emb]
        cond_feat: (B, T, 8)
        delta_t: (B, T, T)
        lengths: (B,) for masking
        """
        
        # 1. Input Projection: 98 â†’ 128
        h = self.proj(X)  # (B, T, 128)
        h = LayerNorm(h)
        
        # 2. TCN Temporal Encoding
        #    Dilated convolutions: receptive field í™•ì¥
        h = TCN_block1(h)  # dilation=1
        h = TCN_block2(h)  # dilation=2
        h = TCN_block3(h)  # dilation=4
        # â†’ (B, T, 128)
        
        # 3. Adaptive Decay Attention
        #    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        #    â”‚ q, k, v = Linear(h)         â”‚
        #    â”‚ q,k,v: (B, heads=4, T, 32)  â”‚
        #    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        #    â”‚ Î» = MLP(cond_feat)          â”‚
        #    â”‚ Î»: (B, heads=4, 1, T)       â”‚
        #    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        #    â”‚ scores = qÂ·k/âˆšd - Î»Â·Î”t      â”‚
        #    â”‚ attn = Softmax(scores)      â”‚
        #    â”‚ out = attn Â· v              â”‚
        #    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        seq_out, pooled, attn = AdaptiveDecayAttention(
            h, cond_feat, delta_t, mask
        )
        # seq_out: (B, T, 128)
        # pooled: (B, 128)  â† ì‹œê°„ í’€ë§ëœ í‘œí˜„
        # attn: (B, heads, T, T)
        
        # 4. Classification
        logits = MLP(pooled)  # (B, 128) â†’ (B, 5)
        
        return logits
```

## ğŸ“ˆ ì„ë² ë”© ì°¨ì› ìš”ì•½

```
ì…ë ¥ ë ˆë²¨:
â”œâ”€ Raw events: variable length
â”œâ”€ Window samples: (B, T=100)
â””â”€ Per-timestep features: 98D
    â”œâ”€ X_frame: 30D (binary)
    â”œâ”€ X_ema: 30D (continuous)
    â”œâ”€ X_vel: 6D (normalized)
    â””â”€ X_emb: 32D (pre-trained)

ë³´ì¡° ì…ë ¥:
â”œâ”€ cond_feat: 8D (for Î»-MLP)
â””â”€ delta_t: (T, T) (time matrix)

ëª¨ë¸ ë‚´ë¶€:
â”œâ”€ Input projection: 98 â†’ 128D
â”œâ”€ TCN hidden: 128D
â”œâ”€ Attention:
â”‚   â”œâ”€ Q, K, V: (heads=4, T, d=32)
â”‚   â”œâ”€ Î»: (heads=4, 1, T)
â”‚   â””â”€ Output: 128D
â””â”€ Final pooling: 128D â†’ 5 classes

ì´ íŒŒë¼ë¯¸í„°: 393,481
```

## ğŸ¯ í•µì‹¬ ì„¤ê³„ ì² í•™

1. **Multi-Modal Fusion**
   - Binary + Continuous + Temporal + Semantic
   - ìƒí˜¸ ë³´ì™„ì  íŠ¹ì§•ë“¤ì˜ ì¡°í•©

2. **Hierarchical Encoding**
   - Low-level: ì„¼ì„œ í™œì„±í™”
   - Mid-level: ì‹œê°„ì  íŒ¨í„´ (EMA, velocity)
   - High-level: ì˜ë¯¸ì  ê´€ê³„ (embeddings)

3. **Adaptive Memory**
   - Î»ë¥¼ ì¡°ê±´ë¶€ í•™ìŠµìœ¼ë¡œ ë©”ëª¨ë¦¬ ê°ì‡  ì¡°ì ˆ
   - í™œë™ ìœ í˜•ì— ë”°ë¼ ë‹¤ë¥¸ ì‹œê°„ ìœˆë„ìš° ì‚¬ìš©

4. **Pre-training + Fine-tuning**
   - Skip-gram ì„ë² ë”© ì‚¬ì „ í•™ìŠµ
   - End-to-end í™œë™ ë¶„ë¥˜ fine-tuning

## ğŸ’¡ ì„±ëŠ¥ ê¸°ì—¬ë„ (ì¶”ì •)

```
X_frame (30D):    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 40% - ê¸°ë³¸ ì„¼ì„œ ì •ë³´
X_ema (30D):      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 35% - ì‹œê°„ í‰í™œí™”
X_vel (6D):       â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 20% - ë™ì  íŠ¹ì§•
X_emb (32D):      â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 15% - ì˜ë¯¸ì  ìœ ì‚¬ë„
Adaptive Î»:       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 30% - ì‹œê°„ ê°ì‡  í•™ìŠµ
TCN:              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘ 25% - ì‹œê°„ íŒ¨í„´ ì¶”ì¶œ
```

**ìµœì¢… ì„±ëŠ¥: 87.83% Validation Accuracy** âœ¨
